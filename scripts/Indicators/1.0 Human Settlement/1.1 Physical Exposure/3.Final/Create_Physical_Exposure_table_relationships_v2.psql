-- script to generate relationships on sample physical exposure tables generated from the views

-- building level
-- results_canada_exposure.canada_exposure_buildings_building_t
-- add pkey
ALTER TABLE results_canada_exposure.canada_exposure_buildings_building_t DROP CONSTRAINT IF EXISTS canada_exposure_buildings_building_t_pkey;
ALTER TABLE results_canada_exposure.canada_exposure_buildings_building_t ADD PRIMARY KEY("BldgID");

-- add fkey from exposure.canada_exposure
ALTER TABLE results_canada_exposure.canada_exposure_buildings_building_t DROP CONSTRAINT IF EXISTS canada_exposure_buildings_building_t_fkey;
ALTER TABLE results_canada_exposure.canada_exposure_buildings_building_t ADD CONSTRAINT canada_exposure_buildings_building_t_fkey FOREIGN KEY ("BldgID") REFERENCES exposure.canada_exposure(id);

-- add fkey from lut.retrofit_costs
ALTER TABLE results_canada_exposure.canada_exposure_buildings_building_t DROP CONSTRAINT IF EXISTS canada_exposure_buildings_building_t_fkey2;
ALTER TABLE results_canada_exposure.canada_exposure_buildings_building_t ADD CONSTRAINT canada_exposure_buildings_building_t_fkey2 FOREIGN KEY ("E_BldgTypeS") REFERENCES lut.retrofit_costs("Eq_BldgType");



-- results_canada_exposure.canada_exposure_people_building_t
-- add pkey
ALTER TABLE results_canada_exposure.canada_exposure_people_building_t DROP CONSTRAINT IF EXISTS canada_exposure_people_building_t_pkey;
ALTER TABLE results_canada_exposure.canada_exposure_people_building_t ADD PRIMARY KEY("BldgID");

-- add fkey from exposure.canada_exposure
ALTER TABLE results_canada_exposure.canada_exposure_people_building_t DROP CONSTRAINT IF EXISTS canada_exposure_people_building_t_fkey;
ALTER TABLE results_canada_exposure.canada_exposure_people_building_t ADD CONSTRAINT canada_exposure_people_building_t_fkey FOREIGN KEY ("BldgID") REFERENCES exposure.canada_exposure(id);



-- results_canada_exposure.canada_exposure_assets_building_t
-- add pkey
ALTER TABLE results_canada_exposure.canada_exposure_assets_building_t DROP CONSTRAINT IF EXISTS canada_exposure_assets_building_t_pkey;
ALTER TABLE results_canada_exposure.canada_exposure_assets_building_t ADD PRIMARY KEY("BldgID");

-- add fkey from exposure.canada_exposure
ALTER TABLE results_canada_exposure.canada_exposure_assets_building_t DROP CONSTRAINT IF EXISTS canada_exposure_assets_building_t_fkey;
ALTER TABLE results_canada_exposure.canada_exposure_assets_building_t ADD CONSTRAINT canada_exposure_assets_building_t_fkey FOREIGN KEY ("BldgID") REFERENCES exposure.canada_exposure(id);



-- sauid
-- results_canada_exposure.canada_exposure_settled_area_sauid_t
-- add pkey
ALTER TABLE results_canada_exposure.canada_exposure_settled_area_sauid_t DROP CONSTRAINT IF EXISTS canada_exposure_settled_area_sauid_t_pkey;
ALTER TABLE results_canada_exposure.canada_exposure_settled_area_sauid_t ADD PRIMARY KEY("Sauid");

-- add fkey to exposure.canada_exposure
ALTER TABLE exposure.canada_exposure DROP CONSTRAINT IF EXISTS canada_exposure_exposure_fkey;
ALTER TABLE exposure.canada_exposure ADD CONSTRAINT canada_exposure_exposure_fkey FOREIGN KEY (sauid) REFERENCES results_canada_exposure.canada_exposure_settled_area_sauid_t("Sauid");

-- add fkey from census.census_2016_canada
ALTER TABLE results_canada_exposure.canada_exposure_settled_area_sauid_t DROP CONSTRAINT IF EXISTS canada_exposure_settled_area_sauid_t_fkey;
ALTER TABLE results_canada_exposure.canada_exposure_settled_area_sauid_t ADD CONSTRAINT canada_exposure_settled_area_sauid_t_fkey FOREIGN KEY ("Sauid") REFERENCES census.census_2016_canada(sauidt);

-- add fkey from boundaries."Geometry_SAUID"
ALTER TABLE results_canada_exposure.canada_exposure_settled_area_sauid_t DROP CONSTRAINT IF EXISTS canada_exposure_settled_area_sauid_t_fkey2;
ALTER TABLE results_canada_exposure.canada_exposure_settled_area_sauid_t ADD CONSTRAINT canada_exposure_settled_area_sauid_t_fkey2 FOREIGN KEY ("Sauid") REFERENCES boundaries."Geometry_SAUID"("SAUIDt");



-- results_canada_exposure.canada_exposure_building_function_sauid_t
-- add pkey
ALTER TABLE results_canada_exposure.canada_exposure_building_function_sauid_t DROP CONSTRAINT IF EXISTS canada_exposure_building_function_sauid_t_pkey;
ALTER TABLE results_canada_exposure.canada_exposure_building_function_sauid_t ADD PRIMARY KEY("Sauid");

-- add fkey to exposure.canada_exposure
ALTER TABLE exposure.canada_exposure DROP CONSTRAINT IF EXISTS canada_exposure_exposure_fkey2;
ALTER TABLE exposure.canada_exposure ADD CONSTRAINT canada_exposure_exposure_fkey2 FOREIGN KEY (sauid) REFERENCES results_canada_exposure.canada_exposure_building_function_sauid_t("Sauid");

-- add fkey from census.census_2016_canada
ALTER TABLE results_canada_exposure.canada_exposure_building_function_sauid_t DROP CONSTRAINT IF EXISTS canada_exposure_building_function_sauid_t_fkey;
ALTER TABLE results_canada_exposure.canada_exposure_building_function_sauid_t ADD CONSTRAINT canada_exposure_building_function_sauid_t_fkey FOREIGN KEY ("Sauid") REFERENCES census.census_2016_canada(sauidt);

-- add fkey from boundaries."Geometry_SAUID"
ALTER TABLE results_canada_exposure.canada_exposure_building_function_sauid_t DROP CONSTRAINT IF EXISTS canada_exposure_building_function_sauid_t_fkey2;
ALTER TABLE results_canada_exposure.canada_exposure_building_function_sauid_t ADD CONSTRAINT canada_exposure_building_function_sauid_t_fkey2 FOREIGN KEY ("Sauid") REFERENCES boundaries."Geometry_SAUID"("SAUIDt");



-- results_canada_exposure.canada_exposure_building_type_sauid_t
-- add pkey
ALTER TABLE results_canada_exposure.canada_exposure_building_type_sauid_t DROP CONSTRAINT IF EXISTS canada_exposure_building_type_sauid_t_pkey;
ALTER TABLE results_canada_exposure.canada_exposure_building_type_sauid_t ADD PRIMARY KEY("Sauid");

-- add fkey on exposure.canada_exposure
ALTER TABLE exposure.canada_exposure DROP CONSTRAINT IF EXISTS canada_exposure_exposure_fkey3;
ALTER TABLE exposure.canada_exposure ADD CONSTRAINT canada_exposure_exposure_fkey3 FOREIGN KEY (sauid) REFERENCES results_canada_exposure.canada_exposure_building_type_sauid_t("Sauid");

-- add fkey from boundaries."Geometry_SAUID"
ALTER TABLE results_canada_exposure.canada_exposure_building_type_sauid_t DROP CONSTRAINT IF EXISTS canada_exposure_building_type_sauid_t_fkey;
ALTER TABLE results_canada_exposure.canada_exposure_building_type_sauid_t ADD CONSTRAINT canada_exposure_building_type_sauid_t_fkey FOREIGN KEY ("Sauid") REFERENCES boundaries."Geometry_SAUID"("SAUIDt");



-- results_canada_exposure.canada_exposure_people_sauid_t
-- add pkey
ALTER TABLE results_canada_exposure.canada_exposure_people_sauid_t DROP CONSTRAINT IF EXISTS canada_exposure_people_sauid_t_pkey;
ALTER TABLE results_canada_exposure.canada_exposure_people_sauid_t ADD PRIMARY KEY("Sauid");

-- add fkey on exposure.canada_exposure
ALTER TABLE exposure.canada_exposure DROP CONSTRAINT IF EXISTS canada_exposure_exposure_fkey4;
ALTER TABLE exposure.canada_exposure ADD CONSTRAINT canada_exposure_exposure_fkey4 FOREIGN KEY (sauid) REFERENCES results_canada_exposure.canada_exposure_people_sauid_t("Sauid");

-- add fkey from boundaries."Geometry_SAUID"
ALTER TABLE results_canada_exposure.canada_exposure_people_sauid_t DROP CONSTRAINT IF EXISTS canada_exposure_people_sauid_t_fkey;
ALTER TABLE results_canada_exposure.canada_exposure_people_sauid_t ADD CONSTRAINT canada_exposure_people_sauid_t_fkey FOREIGN KEY ("Sauid") REFERENCES boundaries."Geometry_SAUID"("SAUIDt");



-- results_canada_exposure.canada_exposure_assets_sauid_t
-- add pkey
ALTER TABLE results_canada_exposure.canada_exposure_assets_sauid_t DROP CONSTRAINT IF EXISTS canada_exposure_assets_sauid_t_pkey;
ALTER TABLE results_canada_exposure.canada_exposure_assets_sauid_t ADD PRIMARY KEY("Sauid");

-- add fkey on exposure.canada_exposure
ALTER TABLE exposure.canada_exposure DROP CONSTRAINT IF EXISTS canada_exposure_exposure_fkey5;
ALTER TABLE exposure.canada_exposure ADD CONSTRAINT canada_exposure_exposure_fkey5 FOREIGN KEY (sauid) REFERENCES results_canada_exposure.canada_exposure_assets_sauid_t("Sauid");

-- add fkey from boundaries."Geometry_SAUID"
ALTER TABLE results_canada_exposure.canada_exposure_assets_sauid_t DROP CONSTRAINT IF EXISTS canada_exposure_assets_sauid_t_fkey;
ALTER TABLE results_canada_exposure.canada_exposure_assets_sauid_t ADD CONSTRAINT canada_exposure_assets_sauid_t_fkey FOREIGN KEY ("Sauid") REFERENCES boundaries."Geometry_SAUID"("SAUIDt");