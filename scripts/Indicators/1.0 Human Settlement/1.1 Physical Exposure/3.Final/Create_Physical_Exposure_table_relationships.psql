-- script to generate relationships on sample physical exposure tables generated from the views

-- building level
-- results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_buildings_building_t
-- add pkey
ALTER TABLE results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_buildings_building_t DROP CONSTRAINT IF EXISTS bldgexp_ca_v2p5p3_master_buildings_building_t_pkey;
ALTER TABLE results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_buildings_building_t ADD PRIMARY KEY("BldgID");

-- add fkey from exposure.bldgexp_ca_v2p5p3_master
ALTER TABLE results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_buildings_building_t DROP CONSTRAINT IF EXISTS bldgexp_ca_v2p5p3_master_buildings_building_t_fkey;
ALTER TABLE results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_buildings_building_t ADD CONSTRAINT bldgexp_ca_v2p5p3_master_buildings_building_t_fkey FOREIGN KEY ("BldgID") REFERENCES exposure.bldgexp_ca_v2p5p3_master(id);



-- results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_people_building_t
-- add pkey
ALTER TABLE results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_people_building_t DROP CONSTRAINT IF EXISTS bldgexp_ca_v2p5p3_master_people_building_t_pkey;
ALTER TABLE results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_people_building_t ADD PRIMARY KEY("BldgID");

-- add fkey from exposure.bldgexp_ca_v2p5p3_master
ALTER TABLE results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_people_building_t DROP CONSTRAINT IF EXISTS bldgexp_ca_v2p5p3_master_people_building_t_fkey;
ALTER TABLE results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_people_building_t ADD CONSTRAINT bldgexp_ca_v2p5p3_master_people_building_t_fkey FOREIGN KEY ("BldgID") REFERENCES exposure.bldgexp_ca_v2p5p3_master(id);



-- results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_assets_building_t
-- add pkey
ALTER TABLE results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_assets_building_t DROP CONSTRAINT IF EXISTS bldgexp_ca_v2p5p3_master_assets_building_t_pkey;
ALTER TABLE results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_assets_building_t ADD PRIMARY KEY("BldgID");

-- add fkey from exposure.bldgexp_ca_v2p5p3_master
ALTER TABLE results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_assets_building_t DROP CONSTRAINT IF EXISTS bldgexp_ca_v2p5p3_master_assets_building_t_fkey;
ALTER TABLE results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_assets_building_t ADD CONSTRAINT bldgexp_ca_v2p5p3_master_assets_building_t_fkey FOREIGN KEY ("BldgID") REFERENCES exposure.bldgexp_ca_v2p5p3_master(id);



-- sauid
-- results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_settled_area_sauid_t
-- add pkey
ALTER TABLE results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_settled_area_sauid_t DROP CONSTRAINT IF EXISTS bldgexp_ca_v2p5p3_master_settled_area_sauid_t_pkey;
ALTER TABLE results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_settled_area_sauid_t ADD PRIMARY KEY("Sauid");

-- add fkey to exposure.bldgexp_ca_v2p5p3_master
ALTER TABLE exposure.bldgexp_ca_v2p5p3_master DROP CONSTRAINT IF EXISTS bldgexp_ca_v2p5p3_master_exposure_fkey;
ALTER TABLE exposure.bldgexp_ca_v2p5p3_master ADD CONSTRAINT bldgexp_ca_v2p5p3_master_exposure_fkey FOREIGN KEY (sauid) REFERENCES results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_settled_area_sauid_t("Sauid");

-- add fkey from census.census_2016_canada
ALTER TABLE results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_settled_area_sauid_t DROP CONSTRAINT IF EXISTS bldgexp_ca_v2p5p3_master_settled_area_sauid_t_fkey;
ALTER TABLE results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_settled_area_sauid_t ADD CONSTRAINT bldgexp_ca_v2p5p3_master_settled_area_sauid_t_fkey FOREIGN KEY ("Sauid") REFERENCES census.census_2016_canada(sauidt);

-- add fkey from boundaries."Geometry_SAUID"
ALTER TABLE results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_settled_area_sauid_t DROP CONSTRAINT IF EXISTS bldgexp_ca_v2p5p3_master_settled_area_sauid_t_fkey2;
ALTER TABLE results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_settled_area_sauid_t ADD CONSTRAINT bldgexp_ca_v2p5p3_master_settled_area_sauid_t_fkey2 FOREIGN KEY ("Sauid") REFERENCES boundaries."Geometry_SAUID"("SAUIDt");



-- results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_building_function_sauid_t
-- add pkey
ALTER TABLE results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_building_function_sauid_t DROP CONSTRAINT IF EXISTS bldgexp_ca_v2p5p3_master_building_function_sauid_t_pkey;
ALTER TABLE results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_building_function_sauid_t ADD PRIMARY KEY("Sauid");

-- add fkey to exposure.bldgexp_ca_v2p5p3_master
ALTER TABLE exposure.bldgexp_ca_v2p5p3_master DROP CONSTRAINT IF EXISTS bldgexp_ca_v2p5p3_master_exposure_fkey2;
ALTER TABLE exposure.bldgexp_ca_v2p5p3_master ADD CONSTRAINT bldgexp_ca_v2p5p3_master_exposure_fkey2 FOREIGN KEY (sauid) REFERENCES results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_building_function_sauid_t("Sauid");

-- add fkey from boundaries."Geometry_SAUID"
ALTER TABLE results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_building_function_sauid_t DROP CONSTRAINT IF EXISTS bldgexp_ca_v2p5p3_master_building_function_sauid_t_fkey2;
ALTER TABLE results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_building_function_sauid_t ADD CONSTRAINT bldgexp_ca_v2p5p3_master_building_function_sauid_t_fkey2 FOREIGN KEY ("Sauid") REFERENCES boundaries."Geometry_SAUID"("SAUIDt");



-- results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_building_type_sauid_t
-- add pkey
ALTER TABLE results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_building_type_sauid_t DROP CONSTRAINT IF EXISTS bldgexp_ca_v2p5p3_master_building_type_sauid_t_pkey;
ALTER TABLE results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_building_type_sauid_t ADD PRIMARY KEY("Sauid");

-- add fkey on exposure.bldgexp_ca_v2p5p3_master
ALTER TABLE exposure.bldgexp_ca_v2p5p3_master DROP CONSTRAINT IF EXISTS bldgexp_ca_v2p5p3_master_exposure_fkey3;
ALTER TABLE exposure.bldgexp_ca_v2p5p3_master ADD CONSTRAINT bldgexp_ca_v2p5p3_master_exposure_fkey3 FOREIGN KEY (sauid) REFERENCES results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_building_type_sauid_t("Sauid");

-- add fkey from boundaries."Geometry_SAUID"
ALTER TABLE results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_building_type_sauid_t DROP CONSTRAINT IF EXISTS bldgexp_ca_v2p5p3_master_building_type_sauid_t_fkey;
ALTER TABLE results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_building_type_sauid_t ADD CONSTRAINT bldgexp_ca_v2p5p3_master_building_type_sauid_t_fkey FOREIGN KEY ("Sauid") REFERENCES boundaries."Geometry_SAUID"("SAUIDt");



-- results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_people_sauid_t
-- add pkey
ALTER TABLE results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_people_sauid_t DROP CONSTRAINT IF EXISTS bldgexp_ca_v2p5p3_master_people_sauid_t_pkey;
ALTER TABLE results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_people_sauid_t ADD PRIMARY KEY("Sauid");

-- add fkey on exposure.bldgexp_ca_v2p5p3_master
ALTER TABLE exposure.bldgexp_ca_v2p5p3_master DROP CONSTRAINT IF EXISTS bldgexp_ca_v2p5p3_master_exposure_fkey4;
ALTER TABLE exposure.bldgexp_ca_v2p5p3_master ADD CONSTRAINT bldgexp_ca_v2p5p3_master_exposure_fkey4 FOREIGN KEY (sauid) REFERENCES results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_people_sauid_t("Sauid");

-- add fkey from boundaries."Geometry_SAUID"
ALTER TABLE results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_people_sauid_t DROP CONSTRAINT IF EXISTS bldgexp_ca_v2p5p3_master_people_sauid_t_fkey;
ALTER TABLE results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_people_sauid_t ADD CONSTRAINT bldgexp_ca_v2p5p3_master_people_sauid_t_fkey FOREIGN KEY ("Sauid") REFERENCES boundaries."Geometry_SAUID"("SAUIDt");



-- results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_assets_sauid_t
-- add pkey
ALTER TABLE results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_assets_sauid_t DROP CONSTRAINT IF EXISTS bldgexp_ca_v2p5p3_master_assets_sauid_t_pkey;
ALTER TABLE results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_assets_sauid_t ADD PRIMARY KEY("Sauid");

-- add fkey on exposure.bldgexp_ca_v2p5p3_master
ALTER TABLE exposure.bldgexp_ca_v2p5p3_master DROP CONSTRAINT IF EXISTS bldgexp_ca_v2p5p3_master_exposure_fkey5;
ALTER TABLE exposure.bldgexp_ca_v2p5p3_master ADD CONSTRAINT bldgexp_ca_v2p5p3_master_exposure_fkey5 FOREIGN KEY (sauid) REFERENCES results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_assets_sauid_t("Sauid");

-- add fkey from boundaries."Geometry_SAUID"
ALTER TABLE results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_assets_sauid_t DROP CONSTRAINT IF EXISTS bldgexp_ca_v2p5p3_master_assets_sauid_t_fkey;
ALTER TABLE results_bldgexp_ca_v2p5p3_master.bldgexp_ca_v2p5p3_master_assets_sauid_t ADD CONSTRAINT bldgexp_ca_v2p5p3_master_assets_sauid_t_fkey FOREIGN KEY ("Sauid") REFERENCES boundaries."Geometry_SAUID"("SAUIDt");